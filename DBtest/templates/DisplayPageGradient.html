<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <style>
        html, body, #map {
        height: 80%;
        margin: 0px;
        padding: 0px
      }
    </style>
</head>
<body>
<div id = "map"></div>
<script async defer src="https://maps.googleapis.com/maps/api/js?key=AIzaSyBOHvH4oWuREojfdAfwD79SiYDDKBwsKdg&libraries=visualization&callback=initMap"></script>
<script>
function initMap() {
  var map = new google.maps.Map(document.getElementById("map"), {
  	center: new google.maps.LatLng(38.0356,-78.5034),
    zoom:15,
    mapTypeId: "roadmap"
  });

  var jsonstring = "{{data}}"; //data passed from flask
            jsonstring = jsonstring.replace(/&#34;/g, "\""); //replace &#34; with "
            console.log(jsonstring);
            var jsondata = JSON.parse(jsonstring);
            var data = jsondata.data; //take "data" field only

	for (i = 0; i < data.length; i++) {
  	place(data[i])
  }

	function place(point) {
  	var hotSpot = new google.maps.LatLng(point[1], point[2])

    var heatMapData = [
    	{location: hotSpot, weight: 1}
    ];
		var heatmap = new google.maps.visualization.HeatmapLayer({
    	data: heatMapData,
      radius: 35,
    });
    var colorInt = 0;
    if (point[0] == "red") {
        colorInt = 1
    }
    var gradient = [
        'rgba('+255*colorInt+', '+255*(1-colorInt)+', 0, 0)',
        'rgba('+255*colorInt+', '+255*(1-colorInt)+', 0, 1)'];
    heatmap.set('gradient', gradient);
    heatmap.setMap(map);
  }
}

</script>
</body>
</html>